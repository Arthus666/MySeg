import{N as f}from"./niivue.es-963f498d.js";import{a as y,o as m,u as b,d as D,h as B,g as N,b as d,c as k,q as s}from"./index-1e170dd9.js";const w={style:{display:"flex"}},C=s("div",{style:{flex:"1",height:"100vh"}},[s("canvas",{id:"left"})],-1),F=s("div",{style:{flex:"1",height:"100vh"}},[s("canvas",{id:"right"})],-1),I=[C,F],P={__name:"NiiContrast",setup(S){const l=y(""),n=new f({dragAndDropEnabled:!0,backColor:[0,0,0,1],show3Dcrosshair:!0}),h=new f({dragAndDropEnabled:!0,backColor:[0,0,0,1],show3Dcrosshair:!0}),a=(e,t)=>{try{e.setRadiologicalConvention(!1),e.attachTo(t),e.setClipPlane([.3,270,0]),e.setRenderAzimuthElevation(120,10),e.setSliceMM(!0),e.opts.multiplanarForceRender=!1,e.graph.autoSizeMultiplanar=!0,e.graph.opacity=1,e.drawOpacity=.5,e.opts.isColorbar=!1,e.loadVolumes([{url:l.value}]),e.setSliceType(e.sliceTypeRender),e.loadDrawingFromUrl(l.value)}catch(o){console.log(o)}},i=localStorage.getItem("user_token"),p=(e,t)=>{N(e,{user_token:i}).then(o=>{if(o.code==="200"){const c=o.data.File.filePath.split("\\").splice(2).join("/");l.value="./api/"+c,d("contrast",o.data.File.fileId,{user_token:i}).then(r=>{console.log("更新记录",r,"contrast")}),t==="left"?a(n,t):t==="right"&&a(h,t),console.log("文件路径：",l.value)}else console.error(o)})},u=(e,t)=>{k(e,{user_token:i}).then(o=>{if(console.log("本地上传"),o.code==="200"){const c=o.data.filePath.split("\\").splice(2).join("/");l.value="./api/"+c,d("contrast",e,{user_token:i}).then(r=>{console.log("更新记录",r,"contrast")}),t==="left"?a(n,t):t==="right"&&a(h,t),console.log("文件路径：",l.value)}else console.error(o)})};return m(()=>{const e=b(),t=JSON.parse(e.query.left),o=JSON.parse(e.query.right);t.type==="local"?u(t.id,"left"):t.type==="cloud"&&p(t.id,"left"),o.type==="local"?u(o.id,"right"):o.type==="cloud"&&p(o.id,"right")}),(e,t)=>(D(),B("div",w,I))}};export{P as default};
